(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{181:function(e,t,r){e.exports=r(426)},425:function(e,t,r){},426:function(e,t,r){"use strict";r.r(t);var a={};r.r(a),r.d(a,"requestRejected",function(){return k}),r.d(a,"resetRequestStatus",function(){return M}),r.d(a,"geocodeRequest",function(){return S}),r.d(a,"changeOrder",function(){return _}),r.d(a,"changeCoords",function(){return y}),r.d(a,"changeMapCenter",function(){return A}),r.d(a,"shapeMarker",function(){return D}),r.d(a,"getInfoLocation",function(){return G}),r.d(a,"getAddressLocation",function(){return N}),r.d(a,"addMarker",function(){return T}),r.d(a,"removeMarker",function(){return w});r(182);var n=r(1),o=r.n(n),c=r(27),u=r(176),s=r(84),l=r(178),d=r(67),i=r(34),m=function(e){var t=Object(n.useState)(null),r=Object(d.a)(t,2),a=r[0],c=r[1],u=e.index;return o.a.createElement(n.Fragment,null,o.a.createElement(i.c,Object.assign({onDragStart:function(e){var t=e.get("target").geometry.getCoordinates();c(t)},onDragEnd:function(t){var r=e.index,a=e.handleChangeCoords,n=t.get("target").geometry.getCoordinates();c(null),a(r,n)},options:{preset:0===u?"islands#redDotIcon":"islands#darkBlueDotIcon",draggable:!0}},e)),a&&o.a.createElement(i.c,{geometry:{coordinates:a},options:{preset:"islands#lightBlueDotIcon",draggable:!1}}))},p=function(e){var t=e.coordinates;return o.a.createElement(i.a,{geometry:{type:"LineString",coordinates:t},options:{draggable:!1,strokeColor:"#000",strokeWidth:5}})},E=function(e){var t=e.mapState,r=e.placemarks,a=e.handleChangeCoords;return o.a.createElement("div",{className:"ya-route"},o.a.createElement("div",{className:"ya-route__map"},o.a.createElement(i.d,null,o.a.createElement(i.b,{state:t,width:"100%",height:"500px"},r.map(function(e,t){return o.a.createElement(n.Fragment,{key:"placemarkFragment".concat(e.id)},o.a.createElement(m,Object.assign({index:t,key:e.id,handleChangeCoords:a},e)),t!==r.length-1&&o.a.createElement(p,{key:"l".concat(e.id),coordinates:[e.geometry.coordinates,r[t+1].geometry.coordinates]}))})))))};E.defaultProps={placemarks:[]};var f=E,b=r(179),g=r.n(b),O=function(e){var t=e.addMarker,r=e.placemarks,a=e.removeMarker,n=e.requestErrorCode;return o.a.createElement("div",{className:"point-panel"},o.a.createElement("div",{className:"point-panel__form"},o.a.createElement(v,{addMarker:t,requestErrorCode:n})),o.a.createElement("div",{className:"point-panel__list"},r&&o.a.createElement(g.a,{dataSource:r,handles:!1,rowKey:"id",row:function(e,t){return o.a.createElement("div",{key:e.id,className:"point"},o.a.createElement("span",{className:"point__info"},o.a.createElement("strong",null,"".concat(t+1,"."))," ".concat(e.properties.balloonContent)),o.a.createElement("a",{href:"#del",className:"point__delete",onClick:function(){return a(e.id)}},o.a.createElement("span",{className:"visually-hidden"},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c")))},onUpdate:function(t,r){(0,e.changeOrder)(r)}})))};O.defaultProps={placemarks:[]};var R=O,v=function(e){var t=Object(n.useState)(""),r=Object(d.a)(t,2),a=r[0],c=r[1],u=Object(n.useState)(null),s=Object(d.a)(u,2),l=s[0],i=s[1],m=e.requestErrorCode;return o.a.createElement(n.Fragment,null,o.a.createElement("form",{action:"#",method:"get",onSubmit:function(t){var r=e.addMarker;t.preventDefault(),a?(r(a),c(""),i(null)):i("\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u0430\u0434\u0440\u0435\u0441")}},o.a.createElement("div",{className:"form-group row"},o.a.createElement("input",{type:"text",name:"placemark-name",className:"form-control",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0430\u0434\u0440\u0435\u0441",onChange:function(e){var t=e.target.value.trim();c(t)},value:a}))),l&&o.a.createElement("div",{className:"error-text"},l),!!m&&o.a.createElement("div",{className:"error-text"},2===m?"\u0410\u0434\u0440\u0435\u0441 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d. \u0418\u0437\u043c\u0435\u043d\u0438\u0442\u0435 \u0437\u0430\u043f\u0440\u043e\u0441.":"\u0412\u043e\u0437\u043d\u0438\u043a\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u043e\u0437\u0436\u0435."))},C=r(180),j=r.n(C),h=function(){return"https://geocode-maps.yandex.ru/1.x/?apikey=c10f7b53-070d-4871-bdef-5c595cfc5e44&format=json"},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(t){return t({type:"REQUEST_REJECTED",data:e})}},M=function(){return function(e){return e({type:"REQUEST_RESET_STATUS"})}},S=function(e,t){return j()({method:"get",url:"".concat(h()).concat(t&&""!==t?"&sco=".concat(t):"","&geocode=").concat(e),headers:{Accept:"application/json","Content-Type":"application/json"}})},_=function(e){return function(t){return t({type:"CHANGE_MARKER_ORDER",data:e})}},y=function(e,t){return function(r){return r({type:"SET_MARKER_COORDS",data:{index:e,coords:t}})}},A=function(e){return function(t){return t({type:"CHANGE_MAP_CENTER",data:e})}},D=function(e,t){return function(r){r({type:"ADD_MARKER",data:{id:Date.now(),geometry:{coordinates:e},properties:{balloonContent:t}}})}},G=function(e){return function(t){return S(e).then(function(e){var r=e.status,a=e.data;if(r>=400)throw new Error("Bad response from server");if(a.response.GeoObjectCollection.featureMember&&a.response.GeoObjectCollection.featureMember.length>0&&a.response.GeoObjectCollection.featureMember[0].GeoObject.Point&&a.response.GeoObjectCollection.featureMember[0].GeoObject.metaDataProperty.GeocoderMetaData){var n=a.response.GeoObjectCollection.featureMember[0].GeoObject.Point.pos,o=a.response.GeoObjectCollection.featureMember[0].GeoObject.metaDataProperty.GeocoderMetaData.Address.formatted;if(""!==n){var c=n.split(" ").reverse().map(function(e){return+e});t(M()),t(D(c,o)),t(A(c))}}else t(k(2))}).catch(function(){return t(k(1))})}},N=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return function(a){return S(t,r).then(function(t){var r=t.status,n=t.data;if(r>=400)throw new Error("Bad response from server");n.response.GeoObjectCollection.featureMember&&n.response.GeoObjectCollection.featureMember.length>0?(a(M()),a({type:"SET_MARKER_ADDRESS",data:{index:e,address:n.response.GeoObjectCollection.featureMember[0].GeoObject.metaDataProperty.GeocoderMetaData.Address.formatted}})):a(k(2))}).catch(function(){return a(k(1))})}},T=function(e){return function(t){t(G(e))}},w=function(e){return function(t,r){t({type:"REMOVE_MARKER",data:r().RouteMapReducer.placemarks.filter(function(t){return t.id!==e})})}},x=Object(s.b)(function(e){return{mapState:e.RouteMapReducer.mapState,placemarks:e.RouteMapReducer.placemarks,requestErrorCode:e.RouteMapReducer.requestErrorCode}},function(e){return{actions:Object(c.b)(a,e)}})(function(e){var t=e.mapState,r=e.placemarks,a=e.requestErrorCode,c=e.actions,u=c.addMarker,s=c.removeMarker,l=c.changeOrder;return o.a.createElement(n.Fragment,null,o.a.createElement(R,{placemarks:r,addMarker:u,removeMarker:s,changeOrder:l,requestErrorCode:a}),o.a.createElement(f,{mapState:t,placemarks:r,handleChangeCoords:function(t,r){var a=e.actions,n=a.changeCoords,o=a.getAddressLocation;n(t,r),o(t,r,"latlong")}}))}),q=r(60),K=r(20),P={mapState:{center:[54.314,48.403],zoom:7,controls:["zoomControl"]},placemarks:[],requestErrorCode:null},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(K.a)({},P),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHANGE_MAP_CENTER":return Object(K.a)({},e,{mapState:Object(K.a)({},e.mapState,{center:t.data})});case"SET_MARKER_ADDRESS":var r=Object(q.a)(e.placemarks);return r[t.data.index].properties.balloonContent=t.data.address,Object(K.a)({},e,{placemarks:r});case"SET_MARKER_COORDS":var a=Object(q.a)(e.placemarks);return a[t.data.index].geometry.coordinates=t.data.coords,Object(K.a)({},e,{placemarks:a});case"CHANGE_MARKER_ORDER":return Object(K.a)({},e,{placemarks:Object(q.a)(t.data)});case"ADD_MARKER":return Object(K.a)({},e,{placemarks:[].concat(Object(q.a)(e.placemarks),[t.data])});case"REMOVE_MARKER":return Object(K.a)({},e,{placemarks:Object(q.a)(t.data)});case"REQUEST_REJECTED":return Object(K.a)({},e,{requestErrorCode:t.data});case"REQUEST_RESET_STATUS":return Object(K.a)({},e,{requestErrorCode:null});default:return e}},B=function(){return Object(c.c)({RouteMapReducer:U})},F=(r(425),function(){return o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"wrapper"},o.a.createElement(x,null)))}),I=Object(c.e)(B(),Object(c.d)(Object(c.a)(l.a)));Object(u.render)(o.a.createElement(s.a,{store:I},o.a.createElement(F,null)),document.getElementById("root"))}},[[181,1,2]]]);
//# sourceMappingURL=main.091b9f8f.chunk.js.map